(function(t){function e(e){for(var a,r,o=e[0],l=e[1],c=e[2],d=0,m=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&m.push(i[r][0]),i[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);u&&u(e);while(m.length)m.shift()();return n.push.apply(n,c||[]),s()}function s(){for(var t,e=0;e<n.length;e++){for(var s=n[e],a=!0,o=1;o<s.length;o++){var l=s[o];0!==i[l]&&(a=!1)}a&&(n.splice(e--,1),t=r(r.s=s[0]))}return t}var a={},i={app:0},n=[];function r(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=a,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(s,a,function(e){return t[e]}.bind(null,a));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;n.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"020f":function(t,e,s){"use strict";var a=s("8688"),i=s.n(a);i.a},"02b4":function(t,e,s){"use strict";var a=s("48d9"),i=s.n(a);i.a},"05af":function(t,e,s){},"12cc":function(t,e,s){"use strict";var a=s("a254"),i=s.n(a);i.a},"14d6":function(t,e,s){},1782:function(t,e,s){t.exports=s.p+"img/init_ico.e6ab5389.png"},"1ef0":function(t,e,s){},2190:function(t,e,s){},"2b97":function(t,e,s){},"2f3d":function(t,e,s){"use strict";var a=s("2b97"),i=s.n(a);i.a},"32c1":function(t,e,s){"use strict";var a=s("37e3"),i=s.n(a);i.a},"32f6":function(t,e,s){},3792:function(t,e,s){"use strict";var a=s("73c6"),i=s.n(a);i.a},"37e3":function(t,e,s){},"3db4":function(t,e,s){},"48d9":function(t,e,s){},"4a41":function(t,e,s){},"4a94":function(t,e,s){"use strict";var a=s("05af"),i=s.n(a);i.a},"4d65":function(t,e,s){"use strict";var a=s("c413"),i=s.n(a);i.a},"56d7":function(t,e,s){"use strict";s.r(e);s("d9a3"),s("c9db"),s("de3e"),s("618d");var a=s("0261"),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},n=[],r=s("5511"),o={},l=Object(r["a"])(o,i,n,!1,null,null,null),c=l.exports,u=s("9bfb"),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home"},[a("manage-header"),a("div",{staticClass:"card-wrap"},[a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{span:6}},[a("el-card",[a("div",{staticClass:"card-box",on:{click:t.dataInit}},[a("span",{staticClass:"title"},[t._v("数据初始化")]),a("img",{staticClass:"ico",attrs:{src:s("1782")}})])])],1),a("el-col",{attrs:{span:6}},[a("el-card",[a("div",{staticClass:"card-box"},[a("router-link",{staticClass:"link",attrs:{to:"/singerManage"}},[a("span",{staticClass:"title"},[t._v("歌手管理")]),a("img",{staticClass:"ico",attrs:{src:s("793f")}})])],1)])],1),a("el-col",{attrs:{span:6}},[a("el-card",[a("div",{staticClass:"card-box"},[a("router-link",{staticClass:"link",attrs:{to:"/albumManage"}},[a("span",{staticClass:"title"},[t._v("专辑管理")]),a("img",{staticClass:"ico",attrs:{src:s("cdfb")}})])],1)])],1),a("el-col",{attrs:{span:6}},[a("el-card",[a("div",{staticClass:"card-box"},[a("router-link",{staticClass:"link",attrs:{to:"/userManage"}},[a("span",{staticClass:"title"},[t._v("用户管理")]),a("img",{staticClass:"ico",attrs:{src:s("7a0e")}})])],1)])],1)],1)],1)],1)},m=[],h=(s("3a20"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"top-nav"},[a("div",{staticClass:"nav-wrap"},[a("router-link",{staticClass:"top-title-wrap",attrs:{to:"/manage"}},[a("div",{staticClass:"top-title"},[a("img",{staticClass:"top-logo",attrs:{src:s("a1d8")}}),t._v("简音乐管理平台 ")])]),a("el-menu",{staticClass:"el-menu",attrs:{"default-active":t.$route.path,mode:"horizontal","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b",router:!0}},[a("el-menu-item",{attrs:{index:"/manage"}},[t._v("首页")]),a("el-menu-item",{attrs:{index:"/singerManage"}},[t._v("歌手管理")]),a("el-menu-item",{attrs:{index:"/albumManage"}},[t._v("专辑管理")]),a("el-menu-item",{attrs:{index:"/userManage"}},[t._v("用户管理")]),a("el-menu-item",{attrs:{index:"/collect"}},[t._v("统计")]),a("el-submenu",{attrs:{index:"4"}},[a("template",{slot:"title"},[t._v("我的")]),a("el-menu-item",{attrs:{index:"4-1"},on:{click:t.exit}},[t._v("退出")])],2)],1)],1)])}),p=[],g={name:"Header",methods:{exit:function(){var t=!1;this.$store.commit("login",t),this.$router.push("/login"),window.console.log("退出登录")}}},f=g,b=(s("995d"),Object(r["a"])(f,h,p,!1,null,"6cd97c3c",null)),v=b.exports,w={name:"home",components:{manageHeader:v},data:function(){return{singerUrl:"http://localhost:3000/singers",albumUrl:"http://localhost:3000/albums"}},methods:{showMsg:function(t,e){t=t||"success",e=e||"success",this.$message({duration:1e3,showClose:!0,message:e,type:t})},dataInit:function(){var t=this;this.$confirm("确定初始化数据吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){fetch(t.singerUrl+"/init",{method:"POST",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){0===e.code?fetch(t.albumUrl+"/init",{method:"POST",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){0===e.code?t.showMsg("success","初始化成功"):t.showMsg("error","初始化失败")})):t.showMsg("error","初始化失败")}))})).catch((function(){t.showMsg("info","已取消初始化")}))}}},_=w,C=(s("92e1"),Object(r["a"])(_,d,m,!1,null,"7110c932",null)),y=C.exports,k=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-header",[s("Header")],1),s("el-form",{ref:"loginFrom",staticClass:"demo-ruleForm login-container",attrs:{model:t.inputUser,rules:t.rules,"label-position":"left","label-width":"0px"}},[s("h3",{staticClass:"title"},[t._v("用户登录")]),s("el-form-item",{attrs:{prop:"name"}},[s("el-input",{attrs:{type:"text","auto-complete":"off",placeholder:"用户名"},model:{value:t.inputUser.name,callback:function(e){t.$set(t.inputUser,"name",e)},expression:"inputUser.name"}})],1),s("el-form-item",{attrs:{prop:"password"}},[s("el-input",{attrs:{type:"password","auto-complete":"off",placeholder:"密码"},model:{value:t.inputUser.password,callback:function(e){t.$set(t.inputUser,"password",e)},expression:"inputUser.password"}})],1),s("el-form-item",{staticStyle:{width:"100%"}},[s("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:t.login}},[t._v("登录")])],1)],1)],1)},x=[],S={data:function(){return{userUrl:"http://localhost:3000/users",inputUser:{},rules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^(\w){6,12}$/,message:"密码由6-12个数字、字母、下划线组成"}]}}},methods:{showMsg:function(t,e){t=t||"success",e=e||"success",this.$message({duration:1e3,showClose:!0,message:e,type:t})},login:function(){var t=this;this.$refs["loginFrom"].validate((function(e){if(!e)return!1;fetch(t.userUrl+"/login/admin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.inputUser)}).then((function(t){return t.json()})).then((function(e){if(0===e.code){var s=!0;t.$store.commit("login",s),t.$router.push("/manage"),window.console.log("登录成功")}else t.showMsg("error",e.msg)}))}))}}},j=S,U=(s("ed9f"),Object(r["a"])(j,k,x,!1,null,"f912bd6a",null)),T=U.exports,$=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"album-wrap"},[s("manage-header"),s("album-search",{attrs:{type:"album"},on:{search:t.searchList}}),s("div",{staticClass:"operate-box"},[s("el-button",{staticClass:"add-btn",attrs:{type:"primary"},on:{click:t.showAdd}},[t._v("新增专辑")])],1),s("el-table",{staticClass:"list",attrs:{data:t.albums}},[s("el-table-column",{attrs:{prop:"album_name",label:"专辑名",width:"100"}}),s("el-table-column",{attrs:{prop:"introduce",label:"简介",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.introduce?s("span",[t._v(t._s(e.row.introduce))]):s("span",[t._v("暂无")])]}}])}),s("el-table-column",{attrs:{prop:"singers",label:"歌手名"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.singers&&e.row.singers.length?s("div",t._l(e.row.singers,(function(e,a){return s("span",{key:a,staticClass:"row-singer"},[t._v(t._s(e.singer_name))])})),0):s("div",[s("span",{staticClass:"row-singer"},[t._v("未知歌手")])])]}}])}),s("el-table-column",{attrs:{prop:"cover",label:"封面图"},scopedSlots:t._u([{key:"default",fn:function(t){return[s("img",{staticClass:"album-cover",attrs:{src:t.row.cover}})]}}])}),s("el-table-column",{attrs:{prop:"users",label:"收藏的用户"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.users&&e.row.users.length?s("div",t._l(e.row.users,(function(e,a){return s("span",{key:a,staticClass:"row-singer"},[t._v(t._s(e.name))])})),0):s("div",[s("span",{staticClass:"row-singer"},[t._v("暂无")])])]}}])}),s("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.showDetail(e.row)}}},[t._v("详情")]),s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.showEdit(e.row)}}},[t._v("编辑")]),s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.deleteAlbum(e.row)}}},[t._v("删除")])]}}])})],1),s("el-dialog",{attrs:{visible:t.detailVisible,width:"50%"},on:{"update:visible":function(e){t.detailVisible=e}}},[s("h3",{staticClass:"dialog-title"},[t._v("详细信息")]),s("div",{staticClass:"detailBox"},[s("p",[s("span",{staticClass:"detail-desc"},[t._v("专辑名称：")]),s("span",[t._v(t._s(t.album.album_name))])]),t.album.introduce?s("p",[s("span",{staticClass:"detail-desc"},[t._v("简介：")]),s("span",[t._v(t._s(t.album.introduce))])]):t._e(),t.album.singers&&t.album.singers.length?s("div",[s("span",{staticClass:"detail-desc"},[t._v("歌手：")]),t._l(t.album.singers,(function(e,a){return s("el-tag",{key:a,staticClass:"singer-tag"},[t._v(t._s(e.singer_name))])}))],2):t._e(),t.album.cover?s("div",{staticClass:"cover-box"},[s("span",{staticClass:"detail-desc"},[t._v("封面图：")]),s("img",{attrs:{src:t.album.cover}})]):t._e(),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.detailVisible=!1}}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.detailVisible=!1}}},[t._v("确 定")])],1)])]),s("el-dialog",{attrs:{"before-close":t.closeAdd,visible:t.addVisible,width:"50%"},on:{"update:visible":function(e){t.addVisible=e}}},[s("h3",{staticClass:"dialog-title"},[t._v("新增专辑")]),s("el-form",{ref:"addForm",staticClass:"add-form",attrs:{rules:t.rules,"label-width":"100px",model:t.album}},[s("el-form-item",{attrs:{label:"专辑名称",prop:"album_name"}},[s("el-input",{attrs:{maxlength:40,placeholder:"请输入专辑名"},model:{value:t.album.album_name,callback:function(e){t.$set(t.album,"album_name",e)},expression:"album.album_name"}})],1),s("el-form-item",{attrs:{label:"专辑简介"}},[s("el-input",{attrs:{maxlength:500,type:"textarea",placeholder:"请输入专辑简介"},model:{value:t.album.introduce,callback:function(e){t.$set(t.album,"introduce",e)},expression:"album.introduce"}})],1),s("el-form-item",{staticClass:"singers-box",attrs:{label:"歌手"}},[t._l(t.album.singers,(function(e,a){return s("el-tag",{key:a,attrs:{closable:"","disable-transitions":!1},on:{close:function(s){return t.tagClose(e)}}},[t._v(t._s(e.singer_name))])})),t.singerInputFlag?s("el-autocomplete",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small","fetch-suggestions":t.querySearchAsync,placeholder:"请选择歌手"},on:{select:t.addSinger},model:{value:t.singerInput,callback:function(e){t.singerInput=e},expression:"singerInput"}}):s("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showSingerInput}},[t._v("+ 歌手")])],2),s("el-form-item",{attrs:{label:"专辑封面"}},[s("el-upload",{ref:"album-upload",staticClass:"upload-demo",attrs:{drag:"",action:t.uploadUrl,"list-type":"picture","on-success":t.uploadSussess,"on-remove":t.clearFiles,"before-upload":t.beforeUpload,limit:1}},[s("div",{staticClass:"upload-btn"},[s("i",{staticClass:"el-icon-upload"}),s("div",{staticClass:"el-upload__text"},[t._v(" 将文件拖到此处，或 "),s("em",[t._v("点击上传")])])])])],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:t.closeAdd}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:t.addAlbum}},[t._v("确 定")])],1)],1),s("el-dialog",{attrs:{"before-close":t.closeEdit,visible:t.editVisible,width:"50%"},on:{"update:visible":function(e){t.editVisible=e}}},[s("h3",{staticClass:"dialog-title"},[t._v("修改信息")]),s("el-form",{ref:"editForm",attrs:{rules:t.rules,"label-width":"100px",model:t.album}},[s("el-form-item",{attrs:{label:"专辑名称",prop:"album_name"}},[s("el-input",{attrs:{maxlength:40,placeholder:"请输入专辑名称"},model:{value:t.album.album_name,callback:function(e){t.$set(t.album,"album_name",e)},expression:"album.album_name"}})],1),s("el-form-item",{attrs:{label:"专辑简介"}},[s("el-input",{attrs:{maxlength:500,placeholder:"请输入专辑简介",type:"textarea"},model:{value:t.album.introduce,callback:function(e){t.$set(t.album,"introduce",e)},expression:"album.introduce"}})],1),s("el-form-item",{staticClass:"singers-box",attrs:{label:"歌手"}},[t._l(t.album.singers,(function(e,a){return s("el-tag",{key:a,attrs:{closable:"","disable-transitions":!1},on:{close:function(s){return t.tagClose(e)}}},[t._v(t._s(e.singer_name))])})),t.singerInputFlag?s("el-autocomplete",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small","fetch-suggestions":t.querySearchAsync,placeholder:"请选择歌手"},on:{select:t.addSinger},model:{value:t.singerInput,callback:function(e){t.singerInput=e},expression:"singerInput"}}):s("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showSingerInput}},[t._v("+ 歌手")])],2),s("el-form-item",{attrs:{label:"专辑封面"}},[s("el-upload",{ref:"album-upload",staticClass:"upload-demo",attrs:{drag:"",action:t.uploadUrl,"list-type":"picture","on-success":t.uploadSussess,"on-remove":t.clearFiles,"before-upload":t.beforeUpload,limit:1,"file-list":t.fileList}},[s("div",{staticClass:"upload-btn"},[s("i",{staticClass:"el-icon-upload"}),s("div",{staticClass:"el-upload__text"},[t._v(" 将文件拖到此处，或 "),s("em",[t._v("点击上传")])])])])],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:t.closeEdit}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:t.editAlbum}},[t._v("确 定")])],1)],1),s("el-pagination",{staticClass:"pagination-box",attrs:{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.pageSize,"current-page":t.pageNum},on:{"update:currentPage":function(e){t.pageNum=e},"update:current-page":function(e){t.pageNum=e},"current-change":t.handleCurrentChange}})],1)},O=[],V=(s("86dd"),s("33c4"),s("af82"),s("4045"),s("c1b0"),s("9a14"),s("391c")),N=s.n(V),E=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"search-box"},[s("el-input",{staticClass:"search-input",attrs:{placeholder:this.des,"prefix-icon":"el-icon-search"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch(e)}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),s("el-button",{attrs:{type:"primary"},on:{click:t.handleSearch}},[t._v("搜索")])],1)},I=[],M={props:{type:String},data:function(){return{keyword:""}},methods:{handleSearch:function(){this.$emit("search",this.keyword)}},computed:{des:function(){var t="";return t="album"===this.type?"请输入专辑":"user"===this.type?"请输入用户":"请输入歌手",t}}},A=M,L=(s("b6f2"),Object(r["a"])(A,E,I,!1,null,"27e20230",null)),F=L.exports,z={components:{AlbumSearch:F,manageHeader:v},created:function(){this.getList(),this.getSingers()},data:function(){return{rules:{album_name:[{required:!0,message:"请输入专辑名称",trigger:"blur"},{min:1,max:40,message:"长度在 1 到 40 个字符",trigger:"blur"}]},searchVal:"",pageSize:5,pageNum:1,total:0,fileList:[],albumUrl:"http://localhost:3000/albums",uploadUrl:"http://localhost:3000/upload",singerUrl:"http://localhost:3000/singers",album:{album_name:"",introduce:"",cover:"",singers:[]},addVisible:!1,editVisible:!1,detailVisible:!1,albums:[],singers:[],singerInputFlag:!1,singerInput:"",timeout:null}},methods:{beforeUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type,s=t.size/1024/1024<2;return e||this.showMsg("error","上传头像图片只能是 JPG、PNG 格式!"),s||this.showMsg("error","上传头像图片大小不能超过 2MB!"),e&&s},querySearchAsync:function(t,e){var s=this.singers,a=t?s.filter(this.createFilter(t)):s;clearTimeout(this.timeout),this.timeout=setTimeout((function(){e(a)}),1e3*Math.random())},createFilter:function(t){return window.console.log(t),function(e){return 0===e.value.toLowerCase().indexOf(t.toLowerCase())}},showSingerInput:function(){var t=this;this.singerInputFlag=!0,this.$nextTick((function(){t.$refs.saveTagInput.$refs.input.focus()}))},addSinger:function(t){this.album.singers.push({singer_name:t.value,_id:t._id}),this.singerInputFlag=!1,this.singerInput=""},albumInit:function(){this.album={album_name:"",introduce:"",cover:"",singers:[]}},handleSingersId:function(){var t=this.album.singers,e=[];t.length&&t.forEach((function(t){e.push(t._id)})),this.album.singers_id=e},addAlbum:function(){var t=this;this.$refs["addForm"].validate((function(e){if(!e)return!1;t.handleSingersId(),fetch(t.albumUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.album)}).then((function(t){return t.json()})).then((function(e){0===e.code?(t.showMsg("success",e.msg),t.albumInit(),t.pageNum=1,t.getList(),t.addVisible=!1,t.clearFiles()):t.showMsg("error",e.msg)}))}))},resetForm:function(t){this.$refs[t].resetFields()},deleteAlbum:function(t){var e=this;this.$confirm("确定删除该专辑吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){fetch(e.albumUrl+"/"+t._id,{method:"DELETE"}).then((function(t){return t.json()})).then((function(t){0===t.code?(e.showMsg("success",t.msg),e.getList()):e.showMsg("error",t.msg)}))})).catch((function(){e.showMsg("info","已取消删除")}))},editAlbum:function(){var t=this;this.editVisible=!1,this.handleSingersId(),fetch(this.albumUrl,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.album)}).then((function(t){return t.json()})).then((function(e){window.console.log(e),0===e.code?(t.showMsg("success",e.msg),t.getList(),t.albumInit()):t.showMsg("error",e.msg)}))},getList:function(){var t=this;fetch(this.albumUrl+"?keyword="+this.searchVal+"&pageSize="+this.pageSize+"&pageNum="+this.pageNum,{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){window.console.log(e),0===e.code&&(t.albums=e.list,t.total=e.total)}))},getSingers:function(){var t=this;fetch(this.singerUrl+"/all",{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){window.console.log(e),0===e.code&&(t.singers=e.list,window.console.log(t.singers))}))},showMsg:function(t,e){t=t||"success",e=e||"success",this.$message({duration:1e3,showClose:!0,message:e,type:t})},searchList:function(t){this.searchVal=t,this.pageNum=1,this.getList()},handleCurrentChange:function(t){this.pageNum=t,this.getList()},clearFiles:function(t,e){window.console.log(t,e),this.$refs["album-upload"].clearFiles()},uploadSussess:function(t){0===t.code&&(this.album.cover=t.data.url)},tagClose:function(t){var e=this.album.singers.findIndex((function(e){return e.singer_name==t.singer_name}));this.album.singers.splice(e,1)},showAdd:function(){this.albumInit(),this.addVisible=!0},closeAdd:function(){this.albumInit(),this.addVisible=!1,this.clearFiles(),this.resetForm("addForm")},showEdit:function(t){this.album=N.a.cloneDeep(t),this.fileList=this.album.cover?[{name:"专辑封面",url:this.album.cover}]:[],this.editVisible=!0},closeEdit:function(){this.albumInit(),this.editVisible=!1,this.clearFiles(),this.resetForm("editForm")},showDetail:function(t){this.detailVisible=!0,this.album=N.a.cloneDeep(t)}}},D=z,P=(s("7d94"),Object(r["a"])(D,$,O,!1,null,"39735488",null)),R=P.exports,H=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"singer-wrap"},[s("manage-header"),s("singer-search",{attrs:{type:"singer"},on:{search:t.searchList}}),s("div",{staticClass:"operate-box"},[s("el-button",{staticClass:"add-btn",attrs:{type:"primary"},on:{click:t.showAdd}},[t._v("新增歌手")])],1),s("el-table",{staticClass:"list",attrs:{data:t.singers}},[s("el-table-column",{attrs:{prop:"singer_name",label:"歌手名",width:"100"}}),s("el-table-column",{attrs:{prop:"introduce",label:"简介",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.introduce?s("span",[t._v(t._s(e.row.introduce))]):s("span",[t._v("暂无")])]}}])}),s("el-table-column",{attrs:{prop:"area",label:"地区"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.area?s("span",[t._v(t._s(e.row.area))]):s("span",[t._v("其他")])]}}])}),s("el-table-column",{attrs:{prop:"cover",label:"封面图"},scopedSlots:t._u([{key:"default",fn:function(t){return[s("img",{staticClass:"singer-cover",attrs:{src:t.row.cover}})]}}])}),s("el-table-column",{attrs:{prop:"albums",label:"专辑"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.albums&&e.row.albums.length?s("div",t._l(e.row.albums,(function(e,a){return s("span",{key:a,staticClass:"row-album"},[t._v(t._s(e.album_name))])})),0):s("div",[s("span",{staticClass:"row-album"},[t._v("暂无")])])]}}])}),s("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.showDetail(e.row)}}},[t._v("详情")]),s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.showEdit(e.row)}}},[t._v("编辑")]),s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.deleteSinger(e.row)}}},[t._v("删除")])]}}])})],1),s("el-dialog",{attrs:{visible:t.detailVisible,width:"50%"},on:{"update:visible":function(e){t.detailVisible=e}}},[s("h3",{staticClass:"dialog-title"},[t._v("详细信息")]),s("div",{staticClass:"detailBox"},[s("p",[s("span",{staticClass:"detail-desc"},[t._v("歌手名称：")]),s("span",[t._v(t._s(t.singer.singer_name))])]),t.singer.introduce?s("p",[s("span",{staticClass:"detail-desc"},[t._v("简介：")]),s("span",[t._v(t._s(t.singer.introduce))])]):t._e(),t.singer.cover?s("div",{staticClass:"cover-box"},[s("span",{staticClass:"detail-desc"},[t._v("封面图：")]),s("img",{attrs:{src:t.singer.cover}})]):t._e(),t.singer.area?s("p",[s("span",{staticClass:"detail-desc"},[t._v("地区：")]),s("span",[t._v(t._s(t.singer.area))])]):t._e(),t.singer.albums&&t.singer.albums.length?s("div",[s("span",{staticClass:"detail-desc"},[t._v("专辑：")]),t._l(t.singer.albums,(function(e,a){return s("el-tag",{key:a,staticClass:"album-tag"},[t._v(t._s(e.album_name))])}))],2):t._e(),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.detailVisible=!1}}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.detailVisible=!1}}},[t._v("确 定")])],1)])]),s("el-dialog",{attrs:{"before-close":t.closeAdd,visible:t.addVisible,width:"50%"},on:{"update:visible":function(e){t.addVisible=e}}},[s("h3",{staticClass:"dialog-title"},[t._v("新增歌手")]),s("el-form",{ref:"addForm",staticClass:"add-form",attrs:{rules:t.rules,"label-width":"100px",model:t.singer}},[s("el-form-item",{attrs:{label:"歌手名称",prop:"singer_name"}},[s("el-input",{attrs:{maxlength:40,placeholder:"请输入歌手名"},model:{value:t.singer.singer_name,callback:function(e){t.$set(t.singer,"singer_name",e)},expression:"singer.singer_name"}})],1),s("el-form-item",{attrs:{label:"歌手简介"}},[s("el-input",{attrs:{maxlength:500,type:"textarea",placeholder:"请输入简介"},model:{value:t.singer.introduce,callback:function(e){t.$set(t.singer,"introduce",e)},expression:"singer.introduce"}})],1),s("el-form-item",{attrs:{label:"地区",prop:"area"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.singer.area,callback:function(e){t.$set(t.singer,"area",e)},expression:"singer.area"}},t._l(t.areaOptions,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),s("el-form-item",{attrs:{label:"封面图"}},[s("el-upload",{ref:"singer-upload",staticClass:"upload-demo",attrs:{drag:"",action:t.uploadUrl,"list-type":"picture","on-success":t.uploadSussess,"on-remove":t.clearFiles,"before-upload":t.beforeUpload,limit:1}},[s("div",{staticClass:"upload-btn"},[s("i",{staticClass:"el-icon-upload"}),s("div",{staticClass:"el-upload__text"},[t._v(" 将文件拖到此处，或 "),s("em",[t._v("点击上传")])])])])],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:t.closeAdd}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:t.addSinger}},[t._v("确 定")])],1)],1),s("el-dialog",{attrs:{"before-close":t.closeEdit,visible:t.editVisible,width:"50%"},on:{"update:visible":function(e){t.editVisible=e}}},[s("h3",{staticClass:"dialog-title"},[t._v("修改信息")]),s("el-form",{ref:"editForm",attrs:{rules:t.rules,"label-width":"100px",model:t.singer}},[s("el-form-item",{attrs:{label:"歌手名称",prop:"singer_name"}},[s("el-input",{attrs:{maxlength:40,placeholder:"请输入歌手名称"},model:{value:t.singer.singer_name,callback:function(e){t.$set(t.singer,"singer_name",e)},expression:"singer.singer_name"}})],1),s("el-form-item",{attrs:{label:"歌手简介"}},[s("el-input",{attrs:{maxlength:500,type:"textarea",placeholder:"请输入歌手简介"},model:{value:t.singer.introduce,callback:function(e){t.$set(t.singer,"introduce",e)},expression:"singer.introduce"}})],1),s("el-form-item",{attrs:{label:"地区",prop:"area"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.singer.area,callback:function(e){t.$set(t.singer,"area",e)},expression:"singer.area"}},t._l(t.areaOptions,(function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),s("el-form-item",{attrs:{label:"封面图"}},[s("el-upload",{ref:"singer-upload",staticClass:"upload-demo",attrs:{drag:"",action:t.uploadUrl,"list-type":"picture","on-success":t.uploadSussess,"on-remove":t.clearFiles,"before-upload":t.beforeUpload,limit:1,"file-list":t.fileList}},[s("div",{staticClass:"upload-btn"},[s("i",{staticClass:"el-icon-upload"}),s("div",{staticClass:"el-upload__text"},[t._v(" 将文件拖到此处，或 "),s("em",[t._v("点击上传")])])])])],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:t.closeEdit}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:t.editSinger}},[t._v("确 定")])],1)],1),s("el-pagination",{staticClass:"pagination-box",attrs:{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.pageSize,"current-page":t.pageNum},on:{"update:currentPage":function(e){t.pageNum=e},"update:current-page":function(e){t.pageNum=e},"current-change":t.handleCurrentChange}})],1)},J=[],G={components:{SingerSearch:F,manageHeader:v},created:function(){this.getList()},data:function(){return{rules:{singer_name:[{required:!0,message:"请输入歌手名称",trigger:"blur"},{min:1,max:40,message:"长度在 1 到 40 个字符",trigger:"blur"}],area:[{required:!0,message:"请选择地区",trigger:"blur"}]},areaOptions:[{value:"华语",label:"华语"},{value:"欧美",label:"欧美"},{value:"日本",label:"日本"},{value:"韩国",label:"韩国"},{value:"其他",label:"其他"}],searchVal:"",pageSize:5,pageNum:1,total:0,fileList:[],uploadUrl:"http://localhost:3000/upload",singerUrl:"http://localhost:3000/singers",singer:{singer_name:"",introduce:"",cover:"",area:"",albums:[]},addVisible:!1,editVisible:!1,detailVisible:!1,singers:[],singerInputFlag:!1,singerInput:"",timeout:null}},methods:{beforeUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type,s=t.size/1024/1024<2;return e||this.showMsg("error","上传头像图片只能是 JPG、PNG 格式!"),s||this.showMsg("error","上传头像图片大小不能超过 2MB!"),e&&s},singerInit:function(){this.singer={singer_name:"",introduce:"",cover:"",singers:[]}},addSinger:function(){var t=this;this.$refs["addForm"].validate((function(e){if(!e)return!1;fetch(t.singerUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.singer)}).then((function(t){return t.json()})).then((function(e){0===e.code?(t.showMsg("success",e.msg),t.singerInit(),t.pageNum=1,t.getList(),t.addVisible=!1,t.clearFiles()):t.showMsg("error",e.msg)}))}))},resetForm:function(t){this.$refs[t].resetFields()},deleteSinger:function(t){var e=this;this.$confirm("确定删除该歌手吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){fetch(e.singerUrl+"/"+t._id,{method:"DELETE"}).then((function(t){return t.json()})).then((function(t){0===t.code?(e.showMsg("success",t.msg),e.getList()):e.showMsg("error",t.msg)}))})).catch((function(){e.showMsg("info","已取消删除")}))},editSinger:function(){var t=this;this.editVisible=!1,fetch(this.singerUrl,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.singer)}).then((function(t){return t.json()})).then((function(e){window.console.log(e),0===e.code?(t.showMsg("success",e.msg),t.getList(),t.singerInit()):t.showMsg("error",e.msg)}))},getList:function(){var t=this;fetch(this.singerUrl+"?keyword="+this.searchVal+"&pageSize="+this.pageSize+"&pageNum="+this.pageNum,{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){window.console.log(e),0===e.code&&(t.singers=e.list,t.total=e.total)}))},showMsg:function(t,e){t=t||"success",e=e||"success",this.$message({duration:1e3,showClose:!0,message:e,type:t})},searchList:function(t){this.searchVal=t,this.pageNum=1,this.getList()},handleCurrentChange:function(t){this.pageNum=t,this.getList()},clearFiles:function(t,e){window.console.log(t,e),this.$refs["singer-upload"].clearFiles()},uploadSussess:function(t){0===t.code&&(this.singer.cover=t.data.url)},showAdd:function(){this.singerInit(),this.addVisible=!0},closeAdd:function(){this.singerInit(),this.addVisible=!1,this.clearFiles(),this.resetForm("addForm")},showEdit:function(t){this.singer=N.a.cloneDeep(t),this.fileList=this.singer.cover?[{name:"歌手封面",url:this.singer.cover}]:[],this.editVisible=!0},closeEdit:function(){this.singerInit(),this.editVisible=!1,this.clearFiles(),this.resetForm("editForm")},showDetail:function(t){this.detailVisible=!0,this.singer=N.a.cloneDeep(t)}}},q=G,B=(s("b4f8"),Object(r["a"])(q,H,J,!1,null,"64ca4378",null)),K=B.exports,W=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"user-wrap"},[s("manage-header"),s("user-search",{attrs:{type:"user"},on:{search:t.searchList}}),s("div",{staticClass:"operate-box"},[s("el-button",{staticClass:"add-btn",attrs:{type:"primary"},on:{click:t.showAdd}},[t._v("新增用户")])],1),s("el-table",{staticClass:"list",attrs:{data:t.users}},[s("el-table-column",{attrs:{prop:"name",label:"用户名",width:"200"}}),s("el-table-column",{attrs:{prop:"root",label:"权限"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.root?s("span",[t._v("管理员")]):s("span",[t._v("普通用户")])]}}])}),s("el-table-column",{attrs:{prop:"albums",label:"收藏专辑"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.albums.length?s("div",t._l(e.row.albums,(function(e,a){return s("span",{key:a,staticClass:"row-album"},[t._v(t._s(e.album_name))])})),0):s("div",[s("span",{staticClass:"row-album"},[t._v("暂无")])])]}}])}),s("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.showDetail(e.row)}}},[t._v("详情")]),s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.showEdit(e.row)}}},[t._v("编辑")]),s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.deleteUser(e.row)}}},[t._v("删除")])]}}])})],1),s("el-dialog",{attrs:{visible:t.detailVisible,width:"40%"},on:{"update:visible":function(e){t.detailVisible=e}}},[s("h3",{staticClass:"dialog-title"},[t._v("详细信息")]),s("div",{staticClass:"detailBox"},[s("p",[s("span",{staticClass:"detail-desc"},[t._v("用户名：")]),s("span",[t._v(t._s(t.user.name))])]),s("p",[s("span",{staticClass:"detail-desc"},[t._v("权限：")]),1===t.user.root?s("span",[t._v("管理员")]):s("span",[t._v("普通用户")])]),t.user.albums&&t.user.albums.length?s("div",[s("span",{staticClass:"detail-desc"},[t._v("专辑：")]),t._l(t.user.albums,(function(e,a){return s("el-tag",{key:a,staticClass:"user-tag"},[t._v(t._s(e.album_name))])}))],2):t._e(),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.detailVisible=!1}}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.detailVisible=!1}}},[t._v("确 定")])],1)])]),s("el-dialog",{attrs:{"before-close":t.closeAdd,visible:t.addVisible,width:"40%"},on:{"update:visible":function(e){t.addVisible=e}}},[s("h3",{staticClass:"dialog-title"},[t._v("新增用户")]),s("el-form",{ref:"addForm",staticClass:"add-form",attrs:{rules:t.rules,"label-width":"100px",model:t.user}},[s("el-form-item",{attrs:{label:"用户名",prop:"name"}},[s("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:t.user.name,callback:function(e){t.$set(t.user,"name",e)},expression:"user.name"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:t.user.password,callback:function(e){t.$set(t.user,"password",e)},expression:"user.password"}})],1),s("el-form-item",{attrs:{label:"管理员"}},[s("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.user.root,callback:function(e){t.$set(t.user,"root",e)},expression:"user.root"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:t.closeAdd}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:t.addUser}},[t._v("确 定")])],1)],1),s("el-dialog",{attrs:{"before-close":t.closeEdit,visible:t.editVisible,width:"40%"},on:{"update:visible":function(e){t.editVisible=e}}},[s("h3",{staticClass:"dialog-title"},[t._v("修改用户信息")]),s("el-form",{ref:"editForm",attrs:{rules:t.rules,"label-width":"100px",model:t.user}},[s("el-form-item",{attrs:{label:"用户名",prop:"name"}},[s("el-input",{attrs:{disabled:!0},model:{value:t.user.name,callback:function(e){t.$set(t.user,"name",e)},expression:"user.name"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:t.user.password,callback:function(e){t.$set(t.user,"password",e)},expression:"user.password"}})],1),s("el-form-item",{attrs:{label:"管理员"}},[s("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:t.user.root,callback:function(e){t.$set(t.user,"root",e)},expression:"user.root"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:t.closeEdit}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:t.editUser}},[t._v("确 定")])],1)],1),s("el-pagination",{staticClass:"pagination-box",attrs:{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.pageSize,"current-page":t.pageNum},on:{"update:currentPage":function(e){t.pageNum=e},"update:current-page":function(e){t.pageNum=e},"current-change":t.handleCurrentChange}})],1)},Z=[],Q={components:{UserSearch:F,manageHeader:v},created:function(){this.getList()},data:function(){return{rules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^(\w){6,12}$/,message:"密码由6-12个数字、字母、下划线组成"}]},searchVal:"",pageSize:5,pageNum:1,total:0,userUrl:"http://localhost:3000/users",user:{name:"",root:0},addVisible:!1,editVisible:!1,detailVisible:!1,users:[],userInputFlag:!1,userInput:"",timeout:null}},methods:{userInit:function(){this.user={name:"",root:0}},addUser:function(){var t=this;this.$refs["addForm"].validate((function(e){if(!e)return!1;fetch(t.userUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.user)}).then((function(t){return t.json()})).then((function(e){0===e.code?(t.showMsg("success",e.msg),t.userInit(),t.pageNum=1,t.getList(),t.addVisible=!1):t.showMsg("error",e.msg)}))}))},resetForm:function(t){this.$refs[t].resetFields()},deleteUser:function(t){var e=this;fetch(this.userUrl+"/"+t._id,{method:"DELETE"}).then((function(t){return t.json()})).then((function(t){0===t.code?(e.showMsg("success",t.msg),e.getList()):e.showMsg("error",t.msg)}))},editUser:function(){var t=this;this.$refs["editForm"].validate((function(e){if(!e)return!1;t.editVisible=!1,fetch(t.userUrl,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.user)}).then((function(t){return t.json()})).then((function(e){window.console.log(e),0===e.code?(t.showMsg("success",e.msg),t.getList(),t.userInit()):t.showMsg("error",e.msg)}))}))},getList:function(){var t=this;fetch(this.userUrl+"?keyword="+this.searchVal+"&pageSize="+this.pageSize+"&pageNum="+this.pageNum,{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){window.console.log(e),0===e.code&&(t.users=e.list,t.total=e.total)}))},showMsg:function(t,e){t=t||"success",e=e||"success",this.$message({duration:1e3,showClose:!0,message:e,type:t})},searchList:function(t){this.searchVal=t,this.pageNum=1,this.getList()},handleCurrentChange:function(t){this.pageNum=t,this.getList()},showAdd:function(){this.userInit(),this.addVisible=!0},closeAdd:function(){this.userInit(),this.addVisible=!1,this.resetForm("addForm")},showEdit:function(t){this.user=N.a.cloneDeep(t),this.editVisible=!0},closeEdit:function(){this.userInit(),this.editVisible=!1,this.resetForm("editForm")},showDetail:function(t){this.detailVisible=!0,this.user=N.a.cloneDeep(t)}}},X=Q,Y=(s("12cc"),Object(r["a"])(X,W,Z,!1,null,"64e62dfe",null)),tt=Y.exports,et=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"collect-wrap"},[s("manage-header"),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.noData,expression:"!noData"}],staticClass:"pie-wrap",attrs:{id:"main"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.noData,expression:"noData"}],staticClass:"no-data"},[s("i",{staticClass:"el-icon-s-promotion"}),t._v(" 暂无数据 ")])],1)},st=[],at=s("5c3d"),it=s.n(at),nt={components:{manageHeader:v},created:function(){this.getHotAlbum()},data:function(){return{noData:!1,pageSize:5,pageNum:1,albumUrl:"http://localhost:3000/albums",hotAlbums:[],charts:"",nameList:[],list:[]}},watch:{hotAlbums:function(){var t=[],e=[];this.hotAlbums.forEach((function(s){var a=s.album_name,i=s.users&&s.users.length;i&&(t.push(a),e.push({value:s.users&&s.users.length,name:s.album_name}))})),e.length?(this.nameList=t,this.list=e,window.console.log(this.nameList),window.console.log(this.list),this.drawPie("main")):this.noData=!0}},methods:{drawPie:function(t){this.charts=it.a.init(document.getElementById(t)),this.charts.setOption({tooltip:{trigger:"item",formatter:"{a}<br/>{b}:{c} ({d}%)"},legend:{orient:"vertical",x:"left",data:this.nameList},series:[{name:"收藏统计",type:"pie",radius:["50%","70%"],avoidLabelOverlap:!1,label:{normal:{show:!1,position:"center"},emphasis:{show:!0,textStyle:{fontSize:"30",fontWeight:"blod"}}},labelLine:{normal:{show:!1}},data:this.list}]})},getHotAlbum:function(){var t=this;fetch(this.albumUrl+"?pageSize="+this.pageSize+"&pageNum="+this.pageNum+"&sort=1",{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){window.console.log(e),0===e.code&&(t.hotAlbums=e.list)}))},showMsg:function(t,e){t=t||"success",e=e||"success",this.$message({duration:1e3,showClose:!0,message:e,type:t})}}},rt=nt,ot=(s("aec0"),Object(r["a"])(rt,et,st,!1,null,"758ed877",null)),lt=ot.exports,ct=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"home-wrap"},[s("top-header"),s("div",{staticClass:"album-wrap"},[s("div",{staticClass:"title-wrap"},[t._m(0),s("router-link",{staticClass:"area-more",attrs:{to:"/album"}},[t._v("更多")])],1),t.albums&&t.albums.length?s("swiper",{staticClass:"swiper-wrap",attrs:{options:t.swiperOption}},[t._l(t.albums,(function(e,a){return s("swiper-slide",{key:a},[s("router-link",{staticClass:"item border-bottom",attrs:{to:"/album/"+e._id}},[s("div",{staticClass:"img-wrap"},[s("img",{attrs:{src:e.cover||t.defaultCover}})])])],1)})),s("div",{staticClass:"swiper-pagination",attrs:{slot:"pagination"},slot:"pagination"}),s("div",{staticClass:"swiper-prev el-icon-arrow-left",attrs:{slot:"button-prev"},slot:"button-prev"}),s("div",{staticClass:"swiper-next el-icon-arrow-right",attrs:{slot:"button-next"},slot:"button-next"})],2):s("div",{staticClass:"no-data"},[s("i",{staticClass:"el-icon-s-promotion"}),t._v(" 暂无数据 ")])],1),s("div",{staticClass:"singer-wrap"},[s("div",{staticClass:"title-wrap"},[t._m(1),s("router-link",{staticClass:"area-more",attrs:{to:"/singer"}},[t._v("更多")])],1),t.singers&&t.singers.length?s("ul",{staticClass:"singer-list"},t._l(t.singers,(function(e,a){return s("router-link",{key:a,staticClass:"item border-bottom",attrs:{tag:"li",to:"/singer/"+e._id}},[s("div",{staticClass:"img-wrap"},[s("img",{attrs:{src:e.cover||t.defaultCover}})]),s("div",{staticClass:"item-info"},[s("span",[t._v(t._s(e.singer_name))])])])})),1):s("div",{staticClass:"no-data"},[s("i",{staticClass:"el-icon-s-promotion"}),t._v(" 暂无数据 ")])]),s("div",{staticClass:"hotAlbum-wrap"},[t._m(2),t.hotAlbums&&t.hotAlbums.length?s("ul",{staticClass:"album-list"},t._l(t.hotAlbums,(function(e,a){return s("router-link",{key:a,staticClass:"item border-bottom",attrs:{tag:"li",to:"/album/"+e._id}},[s("div",{staticClass:"img-wrap"},[s("img",{attrs:{src:e.cover||t.defaultCover}})]),s("div",{staticClass:"item-info"},[s("span",[t._v(t._s(e.album_name))])])])})),1):s("div",{staticClass:"no-data"},[s("i",{staticClass:"el-icon-s-promotion"}),t._v(" 暂无数据 ")])])],1),s("common-footer")],1)},ut=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("h3",{staticClass:"area-title"},[s("i",{staticClass:"title-icon el-icon-collection"}),t._v("新碟首发 ")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("h3",{staticClass:"area-title"},[s("i",{staticClass:"title-icon el-icon-collection"}),t._v("歌手推荐 ")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"title-wrap"},[s("h3",{staticClass:"area-title"},[s("i",{staticClass:"title-icon el-icon-collection"}),t._v("热门专辑 ")])])}],dt=s("b54b"),mt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"top-nav"},[a("div",{staticClass:"nav-wrap"},[a("router-link",{staticClass:"top-title-wrap",attrs:{to:"/music"}},[a("div",{staticClass:"top-title"},[a("img",{staticClass:"top-logo",attrs:{src:s("a1d8")}}),t._v("简音乐 ")])]),a("el-menu",{staticClass:"el-menu",attrs:{"default-active":t.$route.path,mode:"horizontal","background-color":"#333","text-color":"#fff","active-text-color":"#ffd04b",router:!0},on:{select:t.handleSelect}},[a("el-menu-item",{attrs:{index:"/music"}},[t._v("发现音乐")]),a("el-menu-item",{attrs:{index:"/singer"}},[t._v("歌手")]),a("el-menu-item",{attrs:{index:"/album"}},[t._v("专辑")])],1),a("top-search"),t.username?a("div",{staticClass:"user-wrap"},[a("el-dropdown",[a("div",{staticClass:"user-box el-dropdown-link"},[a("img",{attrs:{src:"https://p2.music.126.net/RLeBJe4D1ZzUtltxfoKDMg==/109951163250239066.jpg?param=30y30"}}),a("span",{staticClass:"user-name"},[t._v(t._s(t.username))])]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("router-link",{attrs:{to:"/myMusic/"+t.username}},[t._v("我的收藏")])],1),a("el-dropdown-item",{nativeOn:{click:function(e){return t.exit(e)}}},[t._v("退出")])],1)],1)],1):a("div",{staticClass:"login-wrap"},[a("span",{on:{click:t.showLogin}},[t._v("登录")]),a("i",[t._v("/")]),a("span",{on:{click:t.showAdd}},[t._v("注册")])]),a("el-dialog",{attrs:{"before-close":t.closeAdd,visible:t.addVisible,width:"30%"},on:{"update:visible":function(e){t.addVisible=e}}},[a("h3",{staticClass:"dialog-title"},[t._v("注册")]),a("el-form",{ref:"addForm",staticClass:"add-form",attrs:{rules:t.rules,"label-width":"80px",model:t.user}},[a("el-form-item",{attrs:{label:"用户名",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:t.user.name,callback:function(e){t.$set(t.user,"name",e)},expression:"user.name"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:t.user.password,callback:function(e){t.$set(t.user,"password",e)},expression:"user.password"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.closeAdd}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.addUser}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{"before-close":t.closeLogin,visible:t.loginVisible,width:"30%"},on:{"update:visible":function(e){t.loginVisible=e}}},[a("h3",{staticClass:"dialog-title"},[t._v("登录")]),a("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{rules:t.rules,"label-width":"80px",model:t.user}},[a("el-form-item",{attrs:{label:"用户名",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:t.user.name,callback:function(e){t.$set(t.user,"name",e)},expression:"user.name"}})],1),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:t.user.password,callback:function(e){t.$set(t.user,"password",e)},expression:"user.password"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.closeLogin}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.login}},[t._v("确 定")])],1)],1)],1)])},ht=[],pt=(s("c354"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"search-box"},[s("el-input",{staticClass:"search-input",attrs:{placeholder:"专辑/歌手","prefix-icon":"el-icon-search"},on:{focus:t.handleFocus},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch(e)}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.hasData&&t.resultShow,expression:"hasData && resultShow"}],staticClass:"search-result"},[s("div",{staticClass:"result-wrap"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.hasSingerData,expression:"hasSingerData"}],staticClass:"result-singer"},[t._m(0),s("ul",{staticClass:"result-list"},t._l(t.singerResult,(function(e){return s("router-link",{key:e._id,staticClass:"search-item border-bottom",attrs:{tag:"li",to:"/singer/"+e._id},domProps:{innerHTML:t._s(e.value)}})})),1)]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.hasAlbumData,expression:"hasAlbumData"}],staticClass:"result-album"},[t._m(1),s("ul",{staticClass:"result-list"},t._l(t.albumResult,(function(e){return s("router-link",{key:e._id,staticClass:"search-item border-bottom",attrs:{tag:"li",to:"/album/"+e._id},domProps:{innerHTML:t._s(e.value)},on:{click:t.handleBlur}})})),1)])])]),s("el-button",{attrs:{type:"primary"},on:{click:t.handleSearch}},[t._v("搜索")])],1)}),gt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("h4",{staticClass:"result-title"},[s("i",{staticClass:"el-icon-user"}),t._v("歌手 ")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("h4",{staticClass:"result-title"},[s("i",{staticClass:"el-icon-collection"}),t._v("专辑 ")])}],ft=(s("7ae7"),s("e90c"),s("b3f9"),s("3e5e"),{props:{type:String},created:function(){this.getSingers(),this.getAlbums()},mounted:function(){var t=this;document.addEventListener("click",(function(e){window.console.log(e.target),"el-input__inner"!=e.target.className&&"search-item"!=e.target.className&&(t.resultShow=!1)}))},data:function(){return{singerUrl:"http://localhost:3000/singers",albumUrl:"http://localhost:3000/albums",keyword:"",singerResult:[],albumResult:[],timer:null,singers:[],albums:[],resultShow:!1}},watch:{keyword:function(){var t=this;if(this.timer&&clearTimeout(this.timer),!this.keyword)return this.singerResult=[],void(this.albumResult=[]);this.timer=setTimeout((function(){var e=[],s=[];t.singers.forEach((function(s){if(s.value.indexOf(t.keyword)>-1){var a=N.a.cloneDeep(s),i=a.value.split(t.keyword);a.value=i.join('<span class="search-text">'+t.keyword+"</span>"),e.push(a)}})),t.albums.forEach((function(e){if(e.value.indexOf(t.keyword)>-1){var a=N.a.cloneDeep(e),i=a.value.split(t.keyword);a.value=i.join('<span class="search-text">'+t.keyword+"</span>"),s.push(a)}})),t.singerResult=e,t.albumResult=s,window.console.log(t.singerResult),window.console.log(t.albumResult)}),100)}},methods:{handleFocus:function(){this.resultShow=!0},handleBlur:function(){this.resultShow=!1},handleSearch:function(){this.keyword&&this.$router.push({path:"/search/"+this.keyword})},getSingers:function(){var t=this;fetch(this.singerUrl+"/all",{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){0===e.code&&(t.singers=e.list)}))},getAlbums:function(){var t=this;fetch(this.albumUrl+"/all",{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){0===e.code&&(t.albums=e.list)}))}},computed:{hasSingerData:function(){return this.singerResult.length},hasAlbumData:function(){return this.albumResult.length},hasData:function(){return this.hasSingerData||this.hasAlbumData},collectList:function(){return this.singers.concat(this.albums)}}}),bt=ft,vt=(s("2f3d"),s("63d5"),Object(r["a"])(bt,pt,gt,!1,null,"de52a036",null)),wt=vt.exports,_t=s("08c1"),Ct={components:{TopSearch:wt},name:"Header",computed:Object(dt["a"])({},Object(_t["c"])({loginUser:"user"}),{username:function(){return this.loginUser&&this.loginUser.name}}),props:{link:String},data:function(){return{user:{name:"",root:0},userUrl:"http://localhost:3000/users",addVisible:!1,loginVisible:!1,rules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:10,message:"长度在 2 到 10 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^(\w){6,12}$/,message:"密码由6-12个数字、字母、下划线组成"}]}}},methods:Object(dt["a"])({},Object(_t["b"])(["setUser"]),{userInit:function(){this.user={name:"",root:0}},login:function(){var t=this;this.$refs["loginForm"].validate((function(e){if(!e)return!1;fetch(t.userUrl+"/login/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.user)}).then((function(t){return t.json()})).then((function(e){0===e.code?(t.showMsg("success",e.msg),t.loginVisible=!1,window.console.log(e.data),t.setUser(e.data),window.console.log("登录成功")):t.showMsg("error",e.msg)}))}))},addUser:function(){var t=this;this.$refs["addForm"].validate((function(e){if(!e)return!1;fetch(t.userUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.user)}).then((function(t){return t.json()})).then((function(e){0===e.code?(t.showMsg("success",e.msg),t.addVisible=!1,window.console.log(e.data),t.setUser(e.data)):t.showMsg("error",e.msg)}))}))},resetForm:function(t){this.$refs[t].resetFields()},showAdd:function(){this.userInit(),this.addVisible=!0},showLogin:function(){this.userInit(),this.loginVisible=!0},closeAdd:function(){this.userInit(),this.addVisible=!1,this.resetForm("addForm")},closeLogin:function(){this.userInit(),this.loginVisible=!1,this.resetForm("loginForm")},showMsg:function(t,e){t=t||"success",e=e||"success",this.$message({duration:1e3,showClose:!0,message:e,type:t})},handleSelect:function(t){window.console.log(t)},exit:function(){this.setUser(""),window.console.log("退出登录")}})},yt=Ct,kt=(s("b99a"),Object(r["a"])(yt,mt,ht,!1,null,"5cc9b280",null)),xt=kt.exports,St=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},jt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"footer"},[s("p",[t._v("邮箱：457694438@qq.com")]),s("p",[t._v("联系电话：13261866155")]),s("p",[t._v("新华社《JS 全栈式开发进阶》大作业")])])}],Ut=(s("02b4"),{}),Tt=Object(r["a"])(Ut,St,jt,!1,null,"3fe1951b",null),$t=Tt.exports,Ot={components:{TopHeader:xt,CommonFooter:$t},created:function(){this.getAlbum(),this.getSinger(),this.getHotAlbum()},computed:Object(dt["a"])({},Object(_t["c"])(["defaultCover"])),data:function(){return{swiperSlides:[1,2,3,4,5],swiperOption:{slidesPerView:3,spaceBetween:30,pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-next",prevEl:".swiper-prev"}},pageSize:8,pageNum:1,albumUrl:"http://localhost:3000/albums",singerUrl:"http://localhost:3000/singers",albums:[],singers:[],hotAlbums:[]}},methods:{getAlbum:function(){var t=this;fetch(this.albumUrl+"?pageSize="+this.pageSize+"&pageNum="+this.pageNum,{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){window.console.log(e),0===e.code&&(t.albums=e.list)}))},getHotAlbum:function(){var t=this;fetch(this.albumUrl+"?pageSize="+this.pageSize+"&pageNum="+this.pageNum+"&sort=1",{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){window.console.log(e),0===e.code&&(t.hotAlbums=e.list)}))},getSinger:function(){var t=this;fetch(this.singerUrl+"?pageSize="+this.pageSize+"&pageNum="+this.pageNum,{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){window.console.log(e),0===e.code&&(t.singers=e.list)}))}}},Vt=Ot,Nt=(s("3792"),s("a4b0"),Object(r["a"])(Vt,ct,ut,!1,null,"76dba25c",null)),Et=Nt.exports,It=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"detail-wrap"},[s("top-header"),t.singer&&t.singer.singer_name?s("div",[s("div",{staticClass:"detail-box"},[s("div",{staticClass:"img-wrap"},[s("img",{attrs:{src:t.singer.cover||t.defaultCover}})]),s("div",{staticClass:"item-info"},[s("h3",{staticClass:"item-title"},[t._v(t._s(t.singer.singer_name))]),s("p",{staticClass:"item-area"},[t._v(t._s(t.singer.area))])])]),s("el-tabs",{staticClass:"detail-card",attrs:{type:"border-card"}},[s("el-tab-pane",[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-user"}),t._v(" 歌手简介 ")]),s("div",{staticClass:"album-card"},[s("div",{staticClass:"detail-intro"},[t.singer.introduce?s("div",{staticClass:"intro-content"},[t._v(t._s(t.singer.introduce))]):s("div",{staticClass:"intro-content"},[t._v("暂无介绍")])])])]),s("el-tab-pane",{attrs:{label:"所有专辑"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-collection"}),t._v(" 所有专辑 ")]),s("div",{staticClass:"album-card"},[t.singer.albums&&t.singer.albums.length?s("ul",{staticClass:"album-list"},t._l(t.singer.albums,(function(e,a){return s("router-link",{key:a,staticClass:"item border-bottom",attrs:{tag:"li",to:"/album/"+e._id}},[s("div",{staticClass:"img-wrap"},[s("img",{attrs:{src:e.cover||t.defaultCover}})]),s("div",{staticClass:"item-info"},[s("span",{domProps:{innerHTML:t._s(e.album_name)}})])])})),1):s("div",{staticClass:"no-data"},[s("i",{staticClass:"el-icon-s-promotion"}),t._v(" 暂无专辑 ")])])])],1)],1):s("div",{staticClass:"no-data"},[s("i",{staticClass:"el-icon-s-promotion"}),t._v(" 暂无数据 ")])],1)},Mt=[],At={components:{TopHeader:xt},created:function(){this.getItem()},computed:Object(dt["a"])({},Object(_t["c"])(["defaultCover"])),watch:{$route:function(t,e){window.console.log(t),window.console.log(e),this.singerId=this.$route.params.id,this.getItem()}},data:function(){return{singerId:this.$route.params.id,singerUrl:"http://localhost:3000/singers",singer:{},user:{}}},methods:{getItem:function(){var t=this;fetch(this.singerUrl+"/detail/"+this.singerId,{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){window.console.log(e),0===e.code&&(t.singer=e.data&&e.data[0])}))}}},Lt=At,Ft=(s("8925"),Object(r["a"])(Lt,It,Mt,!1,null,"6474dc94",null)),zt=Ft.exports,Dt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"detail-wrap"},[s("top-header"),t.album&&t.album.album_name?s("div",[s("div",{staticClass:"detail-box"},[s("div",{staticClass:"img-wrap"},[s("img",{attrs:{src:t.album.cover||t.defaultCover}})]),s("div",{staticClass:"item-info"},[s("h3",{staticClass:"item-title"},[s("i",{staticClass:"el-icon-collection"}),t._v(" "+t._s(t.album.album_name)+" ")]),s("p",{staticClass:"item-singer"},[s("i",{staticClass:"el-icon-user"}),t.album.singers.length?t._l(t.album.singers,(function(e,a){return s("router-link",{key:a,staticClass:"singer-name",attrs:{to:"/singer/"+e._id}},[t._v(t._s(e.singer_name))])})):s("span",[t._v("未知歌手")])],2),-1==t.collectIndex?s("el-button",{staticClass:"collect-btn",attrs:{size:"medium"},on:{click:t.addAlbum}},[s("i",{staticClass:"el-icon-star-off"}),t._v("收藏 ")]):s("el-button",{staticClass:"collect-btn collect-on-btn",attrs:{size:"medium"},on:{click:t.removeAlbum}},[s("i",{staticClass:"el-icon-star-on icon-star-on"}),t._v("已收藏 ")])],1)]),s("div",{staticClass:"detail-intro"},[t._m(0),t.album.introduce?s("div",{staticClass:"intro-content"},[t._v(t._s(t.album.introduce))]):s("div",{staticClass:"intro-content"},[t._v("暂无介绍")])])]):s("div",{staticClass:"no-data"},[s("i",{staticClass:"el-icon-s-promotion"}),t._v(" 暂无数据 ")])],1)},Pt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"title-wrap"},[s("h3",{staticClass:"area-title"},[s("i",{staticClass:"title-icon el-icon-collection"}),t._v("专辑简介 ")])])}],Rt={components:{TopHeader:xt},created:function(){this.getItem()},watch:{$route:function(t,e){window.console.log(t),window.console.log(e),this.albumId=this.$route.params.id,this.getItem()}},computed:Object(dt["a"])({},Object(_t["c"])({loginUser:"user",defaultCover:"defaultCover"}),{collectIndex:function(){var t=this,e=this.loginUser.collect,s=-1;return e&&e.length&&(s=e.findIndex((function(e){return e==t.albumId}))),s}}),data:function(){return{albumId:this.$route.params.id,albumUrl:"http://localhost:3000/albums",userUrl:"http://localhost:3000/users",album:{},user:{}}},methods:Object(dt["a"])({},Object(_t["b"])(["setUser"]),{showMsg:function(t,e){t=t||"success",e=e||"success",this.$message({duration:1e3,showClose:!0,message:e,type:t})},addAlbum:function(){var t=this;this.user={name:this.loginUser.name,collect:this.albumId},fetch(this.userUrl+"/addAlbum",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.user)}).then((function(t){return t.json()})).then((function(e){window.console.log(e),0===e.code?(t.showMsg("success",e.msg),t.loginUser.collect.push(t.albumId),t.setUser(t.loginUser)):t.showMsg("error",e.msg)}))},removeAlbum:function(){var t=this;this.user={name:this.loginUser.name,collect:this.albumId},fetch(this.userUrl+"/removeAlbum",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.user)}).then((function(t){return t.json()})).then((function(e){window.console.log(e),0===e.code?(t.showMsg("success",e.msg),t.loginUser.collect.splice(t.collectIndex,1),t.setUser(t.loginUser)):t.showMsg("error",e.msg)}))},getItem:function(){var t=this;fetch(this.albumUrl+"/detail/"+this.albumId,{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){window.console.log(e),0===e.code&&(t.album=e.data&&e.data[0])}))}})},Ht=Rt,Jt=(s("8c95"),Object(r["a"])(Ht,Dt,Pt,!1,null,"1e153f7b",null)),Gt=Jt.exports,qt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"album-wrap"},[s("top-header"),t.albums&&t.albums.length?s("div",[s("ul",{staticClass:"album-list"},t._l(t.albums,(function(e,a){return s("router-link",{key:a,staticClass:"item border-bottom",attrs:{tag:"li",to:"/album/"+e._id}},[s("div",{staticClass:"img-wrap"},[s("img",{attrs:{src:e.cover||t.defaultCover}})]),s("div",{staticClass:"item-info"},[s("span",[t._v(t._s(e.album_name))])])])})),1),s("el-pagination",{staticClass:"pagination-box",attrs:{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.pageSize,"current-page":t.pageNum},on:{"update:currentPage":function(e){t.pageNum=e},"update:current-page":function(e){t.pageNum=e},"current-change":t.handleCurrentChange}})],1):s("div",{staticClass:"no-data"},[s("i",{staticClass:"el-icon-s-promotion"}),t._v(" 暂无数据 ")])],1)},Bt=[],Kt={components:{TopHeader:xt},computed:Object(dt["a"])({},Object(_t["c"])(["defaultCover"])),created:function(){this.getList()},data:function(){return{searchVal:"",pageSize:8,pageNum:1,total:0,albumUrl:"http://localhost:3000/albums",albums:[]}},methods:{getList:function(){var t=this;fetch(this.albumUrl+"?keyword="+this.searchVal+"&pageSize="+this.pageSize+"&pageNum="+this.pageNum,{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){window.console.log(e),0===e.code&&(t.albums=e.list,t.total=e.total)}))},handleCurrentChange:function(t){this.pageNum=t,this.getList()}}},Wt=Kt,Zt=(s("f8fb"),Object(r["a"])(Wt,qt,Bt,!1,null,"5b177a12",null)),Qt=Zt.exports,Xt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"singer-wrap"},[s("top-header"),s("div",{staticClass:"title-wrap"},t._l(t.areaList,(function(e){return s("span",{key:e.id,staticClass:"area-val",class:{active:e.id==t.activeIndex},on:{click:function(s){return t.handleAreaClick(e)}}},[t._v(t._s(e.value))])})),0),t.singers&&t.singers.length?s("div",[s("ul",{staticClass:"singer-list"},t._l(t.singers,(function(e,a){return s("router-link",{key:a,staticClass:"item border-bottom",attrs:{tag:"li",to:"/singer/"+e._id}},[s("div",{staticClass:"img-wrap"},[s("img",{attrs:{src:e.cover||t.defaultCover}})]),s("div",{staticClass:"item-info"},[s("span",[t._v(t._s(e.singer_name))])])])})),1),s("el-pagination",{staticClass:"pagination-box",attrs:{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.pageSize,"current-page":t.pageNum},on:{"update:currentPage":function(e){t.pageNum=e},"update:current-page":function(e){t.pageNum=e},"current-change":t.handleCurrentChange}})],1):s("div",{staticClass:"no-data"},[s("i",{staticClass:"el-icon-s-promotion"}),t._v(" 暂无数据 ")])],1)},Yt=[],te={components:{TopHeader:xt},created:function(){this.getList()},computed:Object(dt["a"])({},Object(_t["c"])(["defaultCover"])),data:function(){return{activeIndex:0,searchVal:"",pageSize:10,pageNum:1,total:0,singerUrl:"http://localhost:3000/singers",singers:[],area:"",areaList:[{value:"全部",id:0},{value:"华语",id:1},{value:"欧美",id:2},{value:"日本",id:3},{value:"韩国",id:4},{value:"其他",id:5}]}},methods:{handleAreaClick:function(t){var e=t.value;this.activeIndex=t.id,this.area="全部"==e?"":e,this.getList()},getList:function(){var t=this;fetch(this.singerUrl+"?keyword="+this.searchVal+"&area="+this.area+"&pageSize="+this.pageSize+"&pageNum="+this.pageNum,{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){window.console.log(e),0===e.code&&(t.singers=e.list,t.total=e.total)}))},handleCurrentChange:function(t){this.pageNum=t,this.getList()}}},ee=te,se=(s("32c1"),Object(r["a"])(ee,Xt,Yt,!1,null,"410d00b6",null)),ae=se.exports,ie=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"album-wrap"},[s("top-header"),t.albums&&t.albums.length?s("div",{staticClass:"album-box"},[s("ul",{staticClass:"album-list"},t._l(t.albums,(function(e,a){return s("router-link",{key:a,staticClass:"item border-bottom",attrs:{tag:"li",to:"/album/"+e._id}},[s("div",{staticClass:"img-wrap"},[s("img",{attrs:{src:e.cover||t.defaultCover}})]),s("div",{staticClass:"item-info"},[s("span",[t._v(t._s(e.album_name))])])])})),1),s("el-pagination",{staticClass:"pagination-box",attrs:{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.pageSize,"current-page":t.pageNum},on:{"update:currentPage":function(e){t.pageNum=e},"update:current-page":function(e){t.pageNum=e},"current-change":t.handleCurrentChange}})],1):s("div",{staticClass:"no-data"},[s("i",{staticClass:"el-icon-s-promotion"}),t._v(" 暂无收藏 ")])],1)},ne=[],re={components:{TopHeader:xt},created:function(){this.getList()},computed:Object(dt["a"])({},Object(_t["c"])({loginUser:"user",defaultCover:"defaultCover"}),{username:function(){return this.loginUser&&this.loginUser.name}}),watch:{username:function(){this.getList()}},data:function(){return{searchVal:"",pageSize:10,pageNum:1,total:0,userUrl:"http://localhost:3000/users",albums:[]}},methods:{getList:function(){var t=this;fetch(this.userUrl+"?keyword="+this.username,{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){window.console.log(e),0===e.code&&(t.albums=e.list[0]&&e.list[0].albums,window.console.log(t.albums))}))},handleCurrentChange:function(t){this.pageNum=t,this.getList()}}},oe=re,le=(s("020f"),Object(r["a"])(oe,ie,ne,!1,null,"bc23cb9e",null)),ce=le.exports,ue=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"search-wrap"},[s("top-header"),s("div",{staticClass:"search-box"},[s("el-input",{staticClass:"search-input",attrs:{placeholder:"搜索专辑、歌手","suffix-icon":"el-icon-search"},on:{focus:t.handleFocus,blur:t.handleBlur},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch(e)}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.resultShow,expression:"resultShow"}],staticClass:"search-result"},[s("div",{staticClass:"result-wrap"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.hasSingerData,expression:"hasSingerData"}],staticClass:"result-singer"},[t._m(0),s("ul",{staticClass:"result-list"},t._l(t.singerResult,(function(e){return s("li",{key:e._id,staticClass:"search-item border-bottom"},[s("router-link",{attrs:{to:"/singer/"+e._id},domProps:{innerHTML:t._s(e.newValue)}})],1)})),0)]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.hasAlbumData,expression:"hasAlbumData"}],staticClass:"result-album"},[t._m(1),s("ul",{staticClass:"result-list"},t._l(t.albumResult,(function(e){return s("li",{key:e._id,staticClass:"search-item border-bottom"},[s("router-link",{attrs:{to:"/album/"+e._id},domProps:{innerHTML:t._s(e.newValue)}})],1)})),0)])])])],1),s("el-tabs",{staticClass:"search-card",attrs:{type:"border-card"}},[s("el-tab-pane",[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-collection"}),t._v(" 专辑 ("+t._s(t.hasAlbumData)+") ")]),s("div",{staticClass:"album-card"},[t.hasAlbumData?s("ul",{staticClass:"album-list"},t._l(t.albumResult,(function(e,a){return s("router-link",{key:a,staticClass:"item border-bottom",attrs:{tag:"li",to:"/album/"+e._id}},[s("div",{staticClass:"img-wrap"},[s("img",{attrs:{src:e.cover||t.defaultCover}})]),s("div",{staticClass:"item-info"},[s("span",{domProps:{innerHTML:t._s(e.newValue)}})])])})),1):s("div",{staticClass:"no-data"},[s("i",{staticClass:"el-icon-s-promotion"}),t._v(" 很抱歉，未能找到相关专辑 ")])])]),s("el-tab-pane",{attrs:{label:"歌手"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"el-icon-user"}),t._v(" 歌手 ("+t._s(t.hasSingerData)+") ")]),s("div",{staticClass:"singer-card"},[t.hasSingerData?s("ul",{staticClass:"singer-list"},t._l(t.singerResult,(function(e,a){return s("router-link",{key:a,staticClass:"item border-bottom",attrs:{tag:"li",to:"/singer/"+e._id}},[s("div",{staticClass:"img-wrap"},[s("img",{attrs:{src:e.cover||t.defaultCover}})]),s("div",{staticClass:"item-info"},[s("span",{domProps:{innerHTML:t._s(e.newValue)}})])])})),1):s("div",{staticClass:"no-data"},[s("i",{staticClass:"el-icon-s-promotion"}),t._v(" 很抱歉，未能找到相关歌手 ")])])])],1)],1)},de=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("h4",{staticClass:"result-title"},[s("i",{staticClass:"el-icon-user"}),t._v("歌手 ")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("h4",{staticClass:"result-title"},[s("i",{staticClass:"el-icon-collection"}),t._v("专辑 ")])}],me={components:{TopHeader:xt},props:{type:String},created:function(){this.getSingers(),this.getAlbums()},mounted:function(){this.getSearchResult()},data:function(){return{singerUrl:"http://localhost:3000/singers",albumUrl:"http://localhost:3000/albums",keyword:this.$route.params.keyword,singerResult:[],albumResult:[],timer:null,singers:[],albums:[],resultShow:!1}},watch:{keyword:function(){this.getSearchResult()}},methods:{handleFocus:function(){window.console.log("has"+this.hasData),this.hasData&&(this.resultShow=!0),window.console.log("show"+this.resultShow)},handleBlur:function(){this.resultShow=!1},handleSearch:function(){this.keyword&&this.$router.push({path:"/search/"+this.keyword})},getSearchResult:function(){var t=this;if(this.timer&&clearTimeout(this.timer),!this.keyword)return this.singerResult=[],void(this.albumResult=[]);this.timer=setTimeout((function(){var e=[],s=[];t.singers.forEach((function(s){if(s.value.indexOf(t.keyword)>-1){var a=N.a.cloneDeep(s),i=a.value.split(t.keyword);a.newValue=i.join('<span class="search-text">'+t.keyword+"</span>"),e.push(a)}})),t.albums.forEach((function(e){if(e.value.indexOf(t.keyword)>-1){var a=N.a.cloneDeep(e),i=a.value.split(t.keyword);a.newValue=i.join('<span class="search-text">'+t.keyword+"</span>"),s.push(a)}})),t.singerResult=e,t.albumResult=s}),100)},getSingers:function(){var t=this;fetch(this.singerUrl+"/all",{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){0===e.code&&(t.singers=e.list)}))},getAlbums:function(){var t=this;fetch(this.albumUrl+"/all",{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){0===e.code&&(t.albums=e.list)}))}},computed:Object(dt["a"])({},Object(_t["c"])(["defaultCover"]),{hasSingerData:function(){return this.singerResult.length},hasAlbumData:function(){return this.albumResult.length},hasData:function(){return this.hasSingerData||this.hasAlbumData},collectList:function(){return this.singers.concat(this.albums)}})},he=me,pe=(s("7bdb"),s("4d65"),s("4a94"),Object(r["a"])(he,ue,de,!1,null,"326c13e0",null)),ge=pe.exports;a["default"].use(u["a"]);var fe=[{path:"/manage",name:"ManageHome",component:y,meta:{requireAuth:!0}},{path:"/singerManage",name:"singerManage",component:K,meta:{requireAuth:!0}},{path:"/albumManage",name:"albumManage",component:R,meta:{requireAuth:!0}},{path:"/userManage",name:"userManage",component:tt,meta:{requireAuth:!0}},{path:"/collect",name:"UserCollect",component:lt,meta:{requireAuth:!0}},{path:"/login",name:"login",component:T},{path:"/",name:"music",component:Et},{path:"/music",name:"music",component:Et},{path:"/singer",name:"singer",component:ae},{path:"/album",name:"album",component:Qt},{path:"/myMusic/:username",name:"myMusic",component:ce},{path:"/singer/:id",name:"sdetail",component:zt},{path:"/album/:id",name:"adetail",component:Gt},{path:"/search/:keyword",name:"searchPage",component:ge}],be=new u["a"]({mode:"hash",base:"/",routes:fe}),ve=u["a"].prototype.push;u["a"].prototype.push=function(t){return ve.call(this,t).catch((function(t){return t}))};var we=be,_e={};try{localStorage.getItem("user")&&(_e=JSON.parse(localStorage.getItem("user")))}catch(Te){window.console.log(Te)}var Ce={user:_e,islogin:"",defaultCover:"http://localhost:3000/upload/file-1580443779650.png",albumUrl:"http://localhost:3000/albums",uploadUrl:"http://localhost:3000/upload",singerUrl:"http://localhost:3000/singers",userUrl:"http://localhost:3000/users"},ye={setUser:function(t,e){t.user=e;try{localStorage.setItem("user",JSON.stringify(e))}catch(Te){window.console.log(Te)}},login:function(t,e){var s=JSON.parse(e);try{localStorage.setItem("islogin",JSON.stringify(s))}catch(Te){window.console.log(Te)}window.console.log(s),t.islogin=s}};a["default"].use(_t["a"]);var ke=new _t["a"].Store({state:Ce,mutations:ye}),xe=s("6fe8"),Se=s.n(xe),je=(s("3db4"),s("664d"),s("2ca7")),Ue=s.n(je);s("46c6");a["default"].config.productionTip=!1,a["default"].use(Ue.a),a["default"].use(Se.a),new a["default"]({router:we,store:ke,render:function(t){return t(c)}}).$mount("#app"),we.beforeEach((function(t,e,s){window.console.log(t),window.console.log(e),t.meta.requireAuth?JSON.parse(localStorage.getItem("islogin"))?s():s({path:"/login"}):s(),"/login"==t.fullPath&&(JSON.parse(localStorage.getItem("islogin"))?s({path:e.fullPath}):s())}))},"63d5":function(t,e,s){"use strict";var a=s("6c1d"),i=s.n(a);i.a},"6c1d":function(t,e,s){},"73c6":function(t,e,s){},"793f":function(t,e,s){t.exports=s.p+"img/singer_ico.4f0214d9.png"},"7a0e":function(t,e,s){t.exports=s.p+"img/user_ico.64957c2a.png"},"7aa7":function(t,e,s){},"7aec":function(t,e,s){},"7bdb":function(t,e,s){"use strict";var a=s("1ef0"),i=s.n(a);i.a},"7d94":function(t,e,s){"use strict";var a=s("14d6"),i=s.n(a);i.a},8688:function(t,e,s){},8925:function(t,e,s){"use strict";var a=s("c5cc"),i=s.n(a);i.a},"8c95":function(t,e,s){"use strict";var a=s("32f6"),i=s.n(a);i.a},"92e1":function(t,e,s){"use strict";var a=s("9dbf"),i=s.n(a);i.a},9931:function(t,e,s){},"995d":function(t,e,s){"use strict";var a=s("e524"),i=s.n(a);i.a},"9dbf":function(t,e,s){},a1d8:function(t,e,s){t.exports=s.p+"img/logo.cd5b9fb2.png"},a254:function(t,e,s){},a4b0:function(t,e,s){"use strict";var a=s("c135"),i=s.n(a);i.a},aec0:function(t,e,s){"use strict";var a=s("9931"),i=s.n(a);i.a},b4f8:function(t,e,s){"use strict";var a=s("2190"),i=s.n(a);i.a},b6f2:function(t,e,s){"use strict";var a=s("4a41"),i=s.n(a);i.a},b99a:function(t,e,s){"use strict";var a=s("cd5c"),i=s.n(a);i.a},c135:function(t,e,s){},c413:function(t,e,s){},c5cc:function(t,e,s){},cd5c:function(t,e,s){},cdfb:function(t,e,s){t.exports=s.p+"img/album_ico.b02ead90.png"},e524:function(t,e,s){},ed9f:function(t,e,s){"use strict";var a=s("7aa7"),i=s.n(a);i.a},f8fb:function(t,e,s){"use strict";var a=s("7aec"),i=s.n(a);i.a}});
//# sourceMappingURL=app.e41ee9cc.js.map